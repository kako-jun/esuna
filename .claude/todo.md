# Esuna 開発TODO

最終更新: 2025年

---

## 🔥 緊急・重要（すぐやる）

### 1. バグ修正・安定化
- [ ] おまかせモードのコンテンツ遷移が正しく動作するか確認
- [ ] 音声メモの容量オーバー時のエラーハンドリング改善
- [ ] ラジオ再生中の音声ガイダンス重複を修正

### 2. ユーザビリティ改善
- [ ] 初回起動時のチュートリアル追加
  - 9グリッドの使い方説明
  - キーボード操作の説明
  - 主要機能の紹介
- [ ] エラーメッセージの音声ガイダンス改善
  - 「エラーが発生しました」→「○○の取得に失敗しました。もう一度お試しください」
- [ ] 読み上げ速度のプリセット追加
  - 超遅（0.5倍）
  - 遅（0.7倍）
  - 標準（1.0倍）
  - 速（1.5倍）
  - 超速（2.0倍）

---

## ⭐ 重要（近日中にやる）

### 3. radiko完全対応
**優先度**: 高（ユーザー要望が多い）

#### タスク
- [ ] radiko認証の調査・実装
  - [ ] partial_key取得
  - [ ] auth_token取得
  - [ ] エリア判定
  - [ ] ストリーミングURL生成
- [ ] radikoライブラリの検討（radiko-py等）
- [ ] タイムフリー再生対応
- [ ] 地域選択UI追加
- [ ] エラーハンドリング（地域外、認証失敗）

#### 技術調査
- radiko APIの仕様確認
- 暗号化方式の理解
- レート制限の確認

---

### 4. 番組表機能
**優先度**: 高（ラジオと合わせて価値向上）

#### タスク
- [ ] NHK番組表API連携
  - [ ] API Key取得
  - [ ] 現在放送中の番組取得
  - [ ] 番組詳細取得
- [ ] radiko番組表取得
  - [ ] スクレイピングまたはAPI利用
- [ ] 番組表UIの作成
  - [ ] 現在の番組表示
  - [ ] 次の番組表示
  - [ ] 番組詳細読み上げ
- [ ] お気に入り番組の登録
- [ ] 番組開始時の通知（オプション）

---

### 5. カレンダー・予定管理
**優先度**: 高（日常生活支援）

#### タスク
- [ ] カレンダーUI設計
  - [ ] 日付選択（音声ナビゲーション）
  - [ ] 予定一覧表示
  - [ ] 予定追加・編集・削除
- [ ] 予定の音声入力対応
- [ ] リマインダー機能
  - [ ] 時刻になったら音声通知
  - [ ] スヌーズ機能
- [ ] Googleカレンダー連携（オプション）
  - [ ] OAuth認証
  - [ ] カレンダー読み込み
  - [ ] 予定の同期

#### データ設計
```typescript
interface CalendarEvent {
  id: string;
  title: string;
  description: string;
  startTime: string; // ISO 8601
  endTime: string;
  reminder: {
    enabled: boolean;
    minutesBefore: number;
  };
  repeat: 'none' | 'daily' | 'weekly' | 'monthly';
}
```

---

## 📝 やりたい（中期的）

### 6. PWA化
**優先度**: 中（UX向上）

#### タスク
- [ ] Service Worker実装
  - [ ] オフラインキャッシュ
  - [ ] バックグラウンド同期
- [ ] manifest.json作成
  - [ ] アイコン作成（複数サイズ）
  - [ ] アプリ名・説明
  - [ ] 表示モード設定
- [ ] インストールプロンプト
- [ ] プッシュ通知（オプション）
- [ ] バックグラウンド再生対応

---

### 7. IndexedDB移行
**優先度**: 中（音声メモ拡張のため）

#### タスク
- [ ] IndexedDB設計
  - [ ] スキーマ定義
  - [ ] マイグレーション戦略
- [ ] LocalStorageからの移行ツール
- [ ] 音声メモの容量制限緩和
  - [ ] 100件→1000件
  - [ ] ファイルサイズ上限拡大
- [ ] 検索機能の実装
  - [ ] タグ検索
  - [ ] 日付範囲検索

---

### 8. 音声ゲーム
**優先度**: 中（娯楽として重要）

#### ゲーム案
1. **しりとりゲーム**
   - [ ] 単語データベース作成
   - [ ] しりとりロジック実装
   - [ ] 音声認識（将来）

2. **数当てゲーム**
   - [ ] ハイ&ロー
   - [ ] 回数制限
   - [ ] スコア記録

3. **クイズゲーム**
   - [ ] ジャンル別問題
   - [ ] 難易度選択
   - [ ] 成績記録

4. **リズムゲーム（音声のみ）**
   - [ ] ビート検出
   - [ ] タイミング判定
   - [ ] スコアリング

---

### 9. 音楽プレイヤー連携
**優先度**: 中（娯楽拡充）

#### タスク
- [ ] Spotify Web API連携
  - [ ] OAuth認証
  - [ ] プレイリスト取得
  - [ ] 再生制御
- [ ] YouTube Music連携（検討）
- [ ] Apple Music連携（検討）
- [ ] ローカル音楽ファイル対応（制限あり）

---

### 10. SNS投稿機能
**優先度**: 低（読み取りが優先）

#### タスク
- [ ] Twitter/X投稿
  - [ ] OAuth認証
  - [ ] テキスト投稿
  - [ ] 音声入力対応
- [ ] Mastodon投稿
  - [ ] アカウント登録
  - [ ] トゥート送信
- [ ] Bluesky投稿（検討）

---

## 🔧 技術的改善

### 11. テストコード追加
**優先度**: 中（品質向上）

#### タスク
- [ ] Jest + React Testing Library セットアップ
- [ ] 単体テスト作成
  - [ ] SpeechManager
  - [ ] ストレージ管理
  - [ ] 各ユーティリティ関数
- [ ] 統合テスト作成
  - [ ] API呼び出し
  - [ ] コンポーネント連携
- [ ] E2Eテスト（Playwright）
  - [ ] 主要フローのテスト

---

### 12. パフォーマンス最適化
**優先度**: 低（現状で十分高速）

#### タスク
- [ ] バンドルサイズ分析
  - [ ] webpack-bundle-analyzer導入
  - [ ] 不要なライブラリ削除
- [ ] Code Splitting改善
  - [ ] 動的importの活用
  - [ ] ルートごとの分割
- [ ] 画像最適化（使用していれば）
- [ ] Lighthouse スコア改善

---

### 13. CI/CD改善
**優先度**: 低

#### タスク
- [ ] GitHub Actions設定
  - [ ] 自動ビルド
  - [ ] 自動テスト
  - [ ] 自動デプロイ
- [ ] Linter/Formatter統一
  - [ ] ESLint設定
  - [ ] Prettier設定
- [ ] コミットメッセージ規約
  - [ ] Conventional Commits採用

---

## 💡 アイデア（将来的に検討）

### 14. AI音声アシスタント
音声コマンドでの操作

- 「おまかせで小説を再生して」
- 「今日のニュースを読んで」
- 「30分後にタイマーをセット」

**技術**:
- Web Speech API (音声認識)
- 自然言語処理
- インテント判定

---

### 15. コミュニティ機能
同じアプリを使う人同士の交流

- おすすめコンテンツの共有
- プレイリスト共有
- 音声掲示板

**懸念**:
- モデレーションが必要
- サーバーコスト増加

---

### 16. 多言語対応
日本語以外にも対応

- 英語
- 中国語
- 韓国語

**タスク**:
- i18n導入
- 翻訳ファイル作成
- 音声合成の言語切り替え

---

### 17. 学習機能
ユーザーの好みを学習して最適化

- よく聞くコンテンツの優先表示
- おまかせモードの最適化
- 読み上げ速度の自動調整

**技術**:
- 機械学習（ブラウザ内）
- 協調フィルタリング

---

## 📊 優先度マトリクス

| 機能 | 重要度 | 緊急度 | 工数 | 優先順位 |
|------|--------|--------|------|----------|
| バグ修正 | 高 | 高 | 小 | 1 |
| チュートリアル | 高 | 高 | 中 | 2 |
| radiko対応 | 高 | 中 | 大 | 3 |
| 番組表 | 高 | 中 | 中 | 4 |
| カレンダー | 高 | 中 | 大 | 5 |
| PWA化 | 中 | 低 | 中 | 6 |
| IndexedDB | 中 | 低 | 中 | 7 |
| 音声ゲーム | 中 | 低 | 中 | 8 |
| 音楽連携 | 中 | 低 | 大 | 9 |
| テストコード | 中 | 低 | 大 | 10 |

---

## 📅 リリース計画

### v0.7.0（次期バージョン）
**目標**: 2025年2月

- [ ] バグ修正・安定化
- [ ] チュートリアル追加
- [ ] エラーメッセージ改善

### v0.8.0
**目標**: 2025年3月

- [ ] radiko完全対応
- [ ] 番組表機能

### v0.9.0
**目標**: 2025年4月

- [ ] カレンダー・予定管理
- [ ] リマインダー機能

### v1.0.0（正式版）
**目標**: 2025年5月

- [ ] PWA化
- [ ] 音声ゲーム
- [ ] ドキュメント整備
- [ ] ユーザーテスト

---

## 🐛 既知のバグ

### 高優先度
1. [ ] おまかせモード実行中に戻ると、次回起動時にエラー
2. [ ] 音声メモが100件を超えるとLocalStorageエラー（エラーハンドリング不足）
3. [ ] ラジオ再生中に他のページに移動すると音声が止まらない

### 中優先度
4. [ ] 長文の読み上げ中にEscapeを押しても止まらないことがある
5. [ ] Podcast再生時、エピソード終了後の自動遷移がない
6. [ ] RSSフィードの取得に失敗してもエラー表示がない

### 低優先度
7. [ ] メインメニューの音声が長すぎる
8. [ ] お気に入り一覧が空の時のメッセージがない
9. [ ] タイマー完了音が小さい

---

## 💭 技術的検討事項

### 1. ストレージ戦略
**現状**: LocalStorage（5-10MB制限）
**検討**: IndexedDB移行（容量大幅増）

**移行タイミング**:
- 音声メモが100件を超える
- お気に入りが増えすぎる
- プレイリスト機能追加時

---

### 2. 音声合成エンジン
**現状**: Web Speech API（ブラウザ依存）
**検討**: 外部API利用（Google Cloud TTS、AWS Polly）

**メリット**:
- より自然な音声
- 音声のカスタマイズ性

**デメリット**:
- コストがかかる
- ネットワーク必須

**結論**: 当面は Web Speech API で十分

---

### 3. バックエンド不要化
**現状**: スクレイピング用にバックエンド必須
**検討**: すべてフロントエンドで完結

**課題**:
- CORS制約
- スクレイピングの制限

**解決策**:
- CORS Proxy利用
- 公式API利用（可能な限り）
- ブラウザ拡張機能化（検討）

---

## 📚 学習・調査が必要な技術

1. [ ] radiko認証の仕組み
2. [ ] IndexedDB の使い方
3. [ ] Service Worker の実装
4. [ ] 音声認識（Web Speech API）
5. [ ] OAuth 2.0認証フロー
6. [ ] PWAのベストプラクティス
7. [ ] Web Audio API（音声ゲーム用）

---

## 🎯 完了したタスク

### v0.6.0（現在のバージョン）
- [x] お気に入り・ブックマーク機能
- [x] 続きから再生機能
- [x] 音声メモ・日記機能
- [x] タイマー・アラーム機能
- [x] ラジオ機能（NHKのみ）
- [x] おまかせモード（自動再生）
- [x] 時刻・天気予報読み上げ
- [x] RSSニュースリーダー
- [x] 9グリッドナビゲーション
- [x] メインメニュー再構成

---

## 📝 メモ

### 開発時の注意点
- すべての機能に音声フィードバックを忘れずに
- 9グリッド制約を必ず守る
- エラー時は必ず音声で通知
- LocalStorageの容量を常に意識

### ユーザーからのフィードバック（想定）
- 「もっと速く読み上げてほしい」→ 速度調整機能強化
- 「radiko使いたい」→ 最優先で対応
- 「予定管理したい」→ カレンダー機能実装
- 「ゲームがほしい」→ 音声ゲーム実装

---

**このTODOリストは定期的に見直し、優先順位を調整します。**
